改进方法：基于联通的方法加空间距离